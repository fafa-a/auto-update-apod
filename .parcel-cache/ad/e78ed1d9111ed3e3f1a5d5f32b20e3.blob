var e=r(require("dotenv"));require("regenerator-runtime/runtime");var a=r(require("axios")),t=r(require("cloudinary")),o=require("@supabase/supabase-js").createClient;function r(e){return e&&e.__esModule?e.default:e}e.config({path:"D:/WorkSpace/Side project/auto-update-apod/.env"});e.config({path:"D:/WorkSpace/Side project/auto-update-apod/.env"}),t.config({cloud_name:"fafa",api_key:"322923197192584",api_secret:"sXJD6O1Vcd6ty8-spk_TOw6h7UE"});const i=async e=>await t.v2.uploader.upload(e,{format:"webp"},(function(e,a){if(!e)return console.log("✔️  Cloudinary upload done"),a;console.log("❌",e)}));e.config({path:"D:/WorkSpace/Side project/auto-update-apod/.env"});const n=o("https://pkonpcjzjjefublfunli.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlhdCI6MTYyMjE1MDAxNywiZXhwIjoxOTM3NzI2MDE3fQ.Jxzer6cLRhtnx7fR8--15uWyMRY3wfMZIalPgFXInZI");e.config();(async()=>{try{const{copyright:e,date:t,explanation:o,hdurl:r,media_type:p,url:c,service_version:l,title:s}=await(async()=>{const e=a.get("https://api.nasa.gov/planetary/apod?api_key=CVmpFpda8Tpzc10wOLge6z3QyM42XEXnNwhHiqSl"),{data:{copyright:t,date:o,explanation:r,hdurl:i,media_type:n,service_version:p,title:c,url:l}}=await e;return{copyright:t,date:o,explanation:r,hdurl:i,media_type:n,url:l,service_version:p,title:c}})(),d=[c,r],u=async e=>{let a=[];try{for(const t of e){const e=await i(t),{secure_url:o}=e;a.push(o)}}catch(t){a.push(e[1])}return a},y=await u(d),[h,g]=y;await(async({title:e,explanation:a,media_type:t,Url:o,hdUrl:r,service_version:i,date:p,copyright:c})=>{const{data:l,error:s}=await n.from("apod").insert([{title:e,explanation:a,date:p,media_type:t,media:{url:o,hdurl:r},copyright:c,service_version:i}]);s?console.error(s):console.log("✔️ Supabase upload done")})({title:s,explanation:o,media_type:p,Url:h,hdUrl:g,service_version:l,date:t,copyright:e}),console.log("✔️  Element added")}catch(e){console.error("❌ ",e.message)}})();
//# sourceMappingURL=index.js.map
